.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SINV.1 1"
.TH SINV.1 1 "2013-02-06" "perl v5.8.8" "User Contributed Perl Documentation"
.SH "\fBNAME\fP"
.IX Header "NAME"
\&\fBsinv\fR \- Checks the software configuration of the nodes in the cluster. 
.SH "\fBSYNOPSIS\fP"
.IX Header "SYNOPSIS"
\&\fBsinv\fR  [\fB\-o\fR \fIoutput\fR] [\fB\-p\fR \fItemplate path\fR] [\fB\-t\fR \fItemplate count\fR] [\fB\-s\fR \fIseed node\fR] [\fB\-i\fR] [\fB\-e\fR] [\fB\-r\fR] [\fB\-V\fR] [\fB\-\-devicetype\fR \fItype_of_device\fR]  [\fB\-l\fR  \fIuserID\fR] [[\fB\-f\fR \fIcommand file\fR] | [\fB\-c\fR \fIcommand\fR]]
.PP
\&\fBsinv\fR [\fB\-h\fR | \fB\-v\fR]
.SH "\fBDESCRIPTION\fP"
.IX Header "DESCRIPTION"
The \fBsinv\fR command is designed to check the configuration of the nodes in a cluster.
The command takes as input command line flags, and one or more templates which will be compared against the output of the xdsh command, designated to be run by the \-c or \-f flag, on the nodes in the noderange. 
.PP
The nodes will then be grouped according to the template they match and a report returned to the administrator in the output file designated by the \-o flag, or to stdout. 
.PP
\&\fBsinv\fR supports checking the output from the  \fBrinv\fR or \fBxdsh\fR command. 
.PP
The \fBsinv\fR command is an xCAT Distributed Shell Utility.
.PP
\&\fB\s-1COMMAND\s0\fR \fB\s-1SPECIFICATION\s0\fR:
.PP
The xdsh or rinv command to execute on the remote targets is specified by the
 \fB\-c\fR flag, or by the \fB\-f\fR flag
which is followed by the fully qualified path to a file containing the command.
.PP
Note: do not add | xdshcoll to the command on the command line or in the
command file, it is automatically added by sinv.
.PP
The syntax for the \fB\-c\fR  \fBsinv\fR parameter is as follows:
.PP
"\fIcommand\fR[; \fIcommand\fR]..."
.PP
where \fIcommand\fR is the command to run on the remote
target. Quotation marks are required to ensure that all commands in the
list are executed remotely, and that any special characters are interpreted
correctly on the remote target. 
.PP
The \fBsinv\fR command does not work with any interactive commands, including
those that read from standard input.
.PP
\&\fB\s-1REMOTE\s0\fR \fB\s-1SHELL\s0\fR \fB\s-1COMMAND\s0\fR:
.PP
For xdsh, support is  explicitly  provided
for  \s-1AIX\s0  Remote  Shell and OpenSSH, but any secure remote command that
conforms to the \s-1IETF\s0 (Internet Engineering Task  Force)  Secure  Remote
Command Protocol can be used. See man \fBxdsh\fR for more details.
.SH "\fBOPTIONS\fP"
.IX Header "OPTIONS"
.IP "\fB\-o\fR|\fB\-\-output\fR \fIreport output file\fR" 5
.IX Item "-o|--output report output file"
Optional output file. This is the location of the file that will contain the report of the nodes that match, and do not match, the input templates.
If the flag is not used, the output will go to stdout. 
.IP "\fB\-p\fR|\fB\-\-tp\fR \fItemplate path\fR" 5
.IX Item "-p|--tp template path"
This is the path to the template file. The template contains the output
of xdsh command, that has been run against a \*(L"seed\*(R" node, a node 
that contains the configuration that you would like  
all nodes in your noderange to match. 
.Sp
The admin can create the template by running the xdsh command on
the seed node, pipe to xdshcoll ( required) and store the output
in the template path. See examples.
.Sp
\&\fBNote:\fR The admin can also edit the
template to remove any lines that they do not want checked.  
.Sp
An alternative method is to use the [\fB\-s\fR \fIseed node\fR] parameter, 
which will automatically build the template for you from the 
seed node named.
.Sp
If a template path file does not exist, and a seed node is not input,
then sinv will automatically use the one node in the noderange as
the seed node and build the template.
.IP "\fB\-t\fR|\fB\-\-tc\fR \fItemplate count\fR" 5
.IX Item "-t|--tc template count"
This count is the number of templates that the command will use
to check for nodes matches.  If the template in the template path does not
match a node, the \fBsinv\fR will check additional templates  up 
to the template count.
.Sp
For each node, it will compare the node against each template to see if 
there is a match.  
If there is no match, and we are not over the template count,
then a new template will be created from the node output. 
This will result in having all nodes that match a given template reported in
their group at the end of the run in the output file. 
If no template count is specified,  0 is the default, and all nodes will
be compared against the first template.
.IP "\fB\-s\fR|\fB\-\-seed\fR \fIseed node\fR" 5
.IX Item "-s|--seed seed node"
This is the node that will be used to build the first template
that is stored in template path.  You can use this parameter instead of running
the command yourself to build the template.
.Sp
\&\fBNote:\fR If the template path file does not exists, and no seed node is 
supplied, the seed node automatically is one node in the
noderange.
.IP "\fB\-i\fR|\fB\-\-ignorefirst\fR" 5
.IX Item "-i|--ignorefirst"
This flag suppresses the reporting of the nodes matching the first
template. In very large systems, you may not want to show the nodes that
have the correct configuration, since the list could contain thousands of nodes.
This allows you to only report the nodes that do not match the required 
configuration. 
.IP "\fB\-e\fR|\fB\-\-exactmatch\fR" 5
.IX Item "-e|--exactmatch"
This requires the check of node output against template to be an exact match.
If this flag is not set, \fBsinv\fR checks to see if the return from the 
xdsh command to the nodes contain a match for each line in the input 
template (except for xdshcoll header and comments). If not in exactmatch mode,
there can exist more lines in the xdsh return from the nodes.
.Sp
For example, if running a \*(L"rpm \-qa | grep xCAT\*(R" command, without exactmatch 
set, if the node containes more xCAT rpms that listed in the template,
it would be considered a match, as long as all rpms listed in the template
were on the node. With exactmatch set, the output must be identical 
to the template. 
.IP "\fB\-\-devicetype\fR \fItype_of_device\fR" 5
.IX Item "--devicetype type_of_device"
Specify a user-defined device type that references the location
of relevant device configuration file. The devicetype value must
correspond to a valid device configuration file.
xCAT ships some default configuration files
for Ethernet switches and and \s-1IB\s0 switches under
\&\fI/opt/xcat/share/xcat/devicetype\fR directory. If you want to overwrite
any of the configuration files, please copy it to \fI/var/opt/xcat/\fR
directory and cutomize it.
For example, \fIbase/IBSwitch/Qlogic/config\fR is the configuration
file location if devicetype is specified as IBSwitch::Qlogic.
xCAT will first search config file using \fI/var/opt/xcat/\fR as the base.
If not found, it will search for it using
\&\fI/opt/xcat/share/xcat/devicetype/\fR as the base.
.IP "\fB\-l\fR|\fB\-\-user\fR \fIuser_ID\fR" 5
.IX Item "-l|--user user_ID"
Specifies a remote user name to use for remote command execution.
.IP "\fB\-c\fR|\fB\-\-command\fR" 5
.IX Item "-c|--command"
The xdsh or rinv command that will be run. The command should be enclosed in 
double quotes to insure correct shell interpretation. This parameter must only contain, the node range or the image path (Linux) or spot name for \s-1AIX\s0. It cannot be used to set additional input flags to xdsh or rinv (for example \-s,\-T,\-e).  See examples below.
.Sp
\&\fBNote:\fR do not add the | xdshcoll to the command,
it is automatically added by sinv.  sinv also automatically sets the \-v flag for xdsh. 
.IP "\fB\-f\fR|\fB\-\-file\fR" 5
.IX Item "-f|--file"
The file containing the xdsh or rinv command that will be run. 
This should be the fully qualified name of the file. 
.Sp
\&\fBNote:\fR do not add the | xdshcoll to the command in the file,
it is automatically added by sinv.
.IP "\fB\-r\fR|\fB\-\-remove\fR" 5
.IX Item "-r|--remove"
This flag indicates that generated templates should be removed at the
at the end of the \fBsinv\fR command execution. 
.Sp
If the flag is input, then all templates that are generated by the \fBsinv\fR
command, will be removed. If the first template is created by the admin,
it will not be removed.
.Sp
If the flag is not input, no
templates will be removed. It is up to the admin to cleanup templates.
.IP "\fB\-h\fR|\fB\-\-help\fR" 5
.IX Item "-h|--help"
Displays usage information.
.IP "\fB\-v\fR|\fB\-\-version\fR" 5
.IX Item "-v|--version"
Displays xCAT release version.
.IP "\fB\-V\fR|\fB\-\-Verbose\fR" 5
.IX Item "-V|--Verbose"
Verbose mode.
.SH "\fBExamples\fP"
.IX Header "Examples"
.IP "\(bu" 3
To setup sinv.template (name optional) for input to the \fBsinv\fR command , enter:
.Sp
\&\fBxdsh\fR \fInode1,node2 \*(L"rpm \-qa | grep ssh \*(R" | xdshcoll  > /tmp/sinv.template\fR
.Sp
Note: when setting up the template the output of xdsh must be piped
	  to xdshcoll, sinv processing depends on it.
.IP "\(bu" 3
To setup rinv.template for input to the \fBsinv\fR command , enter:
.Sp
\&\fBrinv\fR \fInode1\-node2 serial | xdshcoll  > /tmp/rinv.template\fR
.Sp
Note: when setting up the template the output of rinv must be piped
	  to xdshcoll, sinv processing depends on it.
.IP "\(bu" 3
To execute \fBsinv\fR using the sinv.template generated above
on the nodegroup, \fBtestnodes\fR ,possibly generating up to two
new templates, and removing all generated templates in the end, and writing
output report to /tmp/sinv.output, enter:
.Sp
\&\fBsinv\fR \fI \-c \*(L"xdsh testnodes rpm \-qa | grep ssh\*(R" \-p /tmp/sinv.template \-t 2 \-r \-o /tmp/sinv.output\fR
.Sp
Note: do not add the pipe to xdshcoll on the \-c flag, it is automatically
added by the sinv routine.
.IP "\(bu" 3
To execute \fBsinv\fR on noderange, node1\-node4, using the seed node, node8,
to generate the first template, using the xdsh command (\-c),
possibly generating up to two additional
templates and not removing any templates at the end, enter:
.Sp
\&\fBsinv\fR \fI\-c \*(L"xdsh node1\-node4 lslpp \-l | grep bos.adt\*(R" \-s node8 \-p /tmp/sinv.template \-t 2 \-o /tmp/sinv.output\fR 
.IP "\(bu" 3
To execute \fBsinv\fR on noderange, node1\-node4, using the seed node, node8,
to generate the first template, using the rinv command (\-c),
possibly generating up to two additional
templates and removing any generated templates at the end, enter:
.Sp
\&\fBsinv\fR \fI\-c \*(L"rinv node1\-node4 serial\*(R" \-s node8 \-p /tmp/sinv.template \-t 2 \-r \-o /tmp/rinv.output\fR
.IP "\(bu" 3
To execute \fBsinv\fR on noderange, node1\-node4, using node1 as
the seed node, to generate the sinv.template from the xdsh command (\-c),
using the exact match option, generating no additional templates, enter:
.Sp
\&\fBsinv\fR \fI\-c \*(L"xdsh node1\-node4 lslpp \-l | grep bos.adt\*(R"  \-s node1 \-e \-p /tmp/sinv.template  \-o /tmp/sinv.output\fR 
.Sp
Note: the /tmp/sinv.template file must be empty, otherwise it will be used
as an admin generated template.
.IP "\(bu" 3
To execute \fBsinv\fR on the Linux osimage defined for cn1.  First build a template from the /etc/hosts on the node. Then run sinv to compare. 
\&\fBxdsh\fR \fIcn1 \*(L"cat /etc/hosts\*(R" | xdshcoll \fR /tmp/sinv2/template" 
.Sp
\&\fBsinv\fR \fI\-c \*(L"xdsh \-i /install/netboot/rhels6/ppc64/test_ramdisk_statelite/rootimg cat /etc/hosts\*(R"  \-e \-t1 \-p /tmp/sinv.template  \-o /tmp/sinv.output\fR 
.IP "\(bu" 3
To execute \fBsinv\fR on the \s-1AIX\s0 \s-1NIM\s0 611dskls spot and compare /etc/hosts to compute1 node, run the following:
.Sp
\&\fBxdsh\fR \fIcompute1 \*(L"cat /etc/hosts\*(R" | xdshcoll \fR /tmp/sinv2/template" 
.Sp
\&\fBsinv\fR \fI\-c \*(L"xdsh \-i 611dskls  cat /etc/hosts\*(R" \-e \-t1 \-p /tmp/sinv.template  \-o /tmp/sinv.output\fR 
.IP "\(bu" 3
To execute \fBsinv\fR on the device mswitch2 and compare to mswitch1
.Sp
\&\fBsinv\fR \fI\-c \*(L"xdsh mswitch  enable;show version\*(R"  \-s mswitch1 \-p /tmp/sinv/template \-\-devicetype IBSwitch::Mellanox \-l admin \-t 2\fR
.PP
\&\fBFiles\fR
.PP
\&\fB/opt/xcat/bin/sinv/\fR
.PP
Location of the sinv command.
.SH "\fBSEE ALSO\fP"
.IX Header "SEE ALSO"
L <\fIxdsh\fR\|(1)|xdsh.1>, \fInoderange\fR\|(3)
