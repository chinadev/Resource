.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SNMOVE.1 1"
.TH SNMOVE.1 1 "2013-02-06" "perl v5.8.8" "User Contributed Perl Documentation"
.SH "NAME"
\&\fBsnmove\fR \- Move xCAT compute nodes to a different xCAT service node.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBsnmove\fR \fInoderange\fR [\fB\-V\fR] [\fB\-l\fR|\fB\-\-liteonly\fR] [\fB\-d\fR|\fB\-\-dest\fR \fIsn2\fR] [\fB\-D\fR|\fB\-\-destn\fR \fIsn2n\fR] [\fB\-i\fR|\fB\-\-ignorenodes\fR] [\fB\-P\fR|\fB\-\-postscripts\fR \fIscript1,script2...\fR|\fIall\fR]
.PP
\&\fBsnmove\fR [\fB\-V\fR] [\fB\-l\fR|\fB\-\-liteonly\fR] \fB\-s\fR|\fB\-\-source\fR \fIsn1\fR [\fB\-S\fR|\fB\-\-sourcen\fR \fIsn1n\fR] [\fB\-d\fR|\fB\-\-dest\fR \fIsn2\fR] [\fB\-D\fR|\fB\-\-destn\fR \fIsn2n\fR] [\fB\-i\fR|\fB\-\-ignorenodes\fR] [\fB\-P\fR|\fB\-\-postscripts\fR \fIscript1,script2...\fR|\fIall\fR]
.PP
\&\fBsnmove\fR [\fB\-h\fR|\fB\-\-help\fR|\fB\-v\fR|\fB\-\-version\fR]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The \fBsnmove\fR command may be used to move a node or nodes from one service node to another backup service node.
.PP
The use of backup service nodes in an xCAT hierarchical cluster can
help improve the overall reliability, availability, and serviceability
of the cluster.
.PP
Before you run the \fBsnmove\fR command it is assumed that the backup
service node has been configured properly to manage the new node
or nodes. (See the xCAT document named
\&\*(L"Using xCAT Service Nodes with \s-1AIX\s0\*(R" for information on how to set
up backup \s-1AIX\s0 service nodes.).
.PP
The \fBsnmove\fR command can use the information stored in the xCAT
database or information passed in on the command line to determine
the current service node and the backup service node.
.PP
To specify the primary and backup service nodes you can set the
\&\*(L"servicenode\*(R" attribute of the node definitions.
.PP
The \fBservicenode\fR attribute is the hostname of the xCAT service node
as it is known by the management node. The \fBxcatmaster\fR attribute
is the hostname of the xCAT service node as known by the node.
The \fBservicenode\fR attribute should be set to a comma-separated list
so that the primary service node is first and the backup service
node is second.  The \fBxcatmaster\fR attribute must be set to the
hostname of the primary service node as it is known by the node.
.PP
When the \fBsnmove\fR command is run it modifies the xCAT database to
switch the the primary server to the backup server.
.PP
It will also check the other services that are being used for the
node (tftpserver, monserver, nfsserver, conserver), and if they were set 
to the original service node they will be changed to point to the backup
service node. 
.PP
By default the command will modify the nodes so that they will be able to be managed by the backup service node.
.PP
If the \-i option is specified, the nodes themselves will not be modified.
.PP
You can also have postscripts executed on the nodes by using the \-P option if needed.
.PP
The xCAT \fBsnmove\fR command may also be used to synchronize statelite persistent files from the primary service node to the backup service node without actually moving the nodes to the backup servers.
.PP
If you run the command with the \*(L"\-l\*(R" option it will attempt to use rsync to update the statelite persistent directory on the backup service node. This will only be done if the server specified in the \*(L"statelite\*(R" table is the primary service node. 
.PP
When the \fBsnmove\fR command is executed the new service node must be running but
the original service node may be down.
.PP
Note: On a Linux cluster, for \s-1NFS\s0 statelite nodes that do not use external \s-1NFS\s0 server, if the original service node is down, the nodes it manages will be down too. You must run nodeset command and then reboot the nodes after running snmove. For stateless nodes and RAMDisk statelite nodes, the nodes will be up even if the original service node is down. However, make sure to run nodeset command if you decide to reboot the nodes later.   
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-d|\-\-dest\fR" 10
.IX Item "-d|--dest"
Specifies the hostname of the new destination service node as known by (facing) the management node. 
.IP "\fB\-D|\-\-destn\fR" 10
.IX Item "-D|--destn"
Specifies the hostname of the destination service node as known by (facing) the nodes.
.IP "\fB\-h|\-\-help\fR" 10
.IX Item "-h|--help"
Display usage message.
.IP "\fB\-i|\-\-ignorenodes\fR" 10
.IX Item "-i|--ignorenodes"
No modifications will be made on the nodes. If not specified, several xCAT postscripts will be run on the nodes to complete the switch to the new service node.
.IP "\fB\-l|\-\-liteonly\fR" 10
.IX Item "-l|--liteonly"
Use this option to \s-1ONLY\s0 synchronize any \s-1AIX\s0 statelite files from the primary server to the backup server for the nodes. It will not do the actual moving of thre nodes the the backup servers.
.IP "\fB\-P|\-\-postscripts\fR" 10
.IX Item "-P|--postscripts"
Specifies a list of extra postscripts to be run on the nodes after the nodes are moved over to the new serive node. If 'all' is specified, all the postscripts defined in the postscripts table will be run for the nodes. The specified postscripts must be stored under /install/postscripts directory. 
.IP "\fB\-s|\-\-source\fR" 10
.IX Item "-s|--source"
Specifies the hostname of the current (source) service node sa known by (facing)
 the management node.
.IP "\fB\-S|\-\-sourcen\fR" 10
.IX Item "-S|--sourcen"
Specifies the hostname of the current service node adapter as known by (facing)
the nodes.
.IP "\fB\-V|\-\-verbose\fR" 10
.IX Item "-V|--verbose"
Verbose mode.
.IP "\fB\-v|\-\-version\fR" 10
.IX Item "-v|--version"
Command Version.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
.IP "1." 3
Move the nodes contained in group \*(L"group1\*(R" to the service node named \*(L"xcatsn02\*(R".
.Sp
\&\fBsnmove group1 \-d xcatsn02 \-D xcatsn02\-eth1\fR
.IP "2." 3
Move all the nodes that use service node xcatsn01 to service node xcatsn02.
.Sp
\&\fBsnmove \-s xcatsn01 \-S xcatsn01\-eth1 \-d xcatsn02 \-D xcatsn02\-eth1\fR
.IP "3." 3
Move any nodes that have sn1 as their primary server to the backup service node set in the xCAT node definition.
.Sp
\&\fBsnmove \-s sn1\fR
.IP "4." 3
Move all the nodes in the xCAT group named \*(L"nodegroup1\*(R" to their backup SNs.
.Sp
\&\fBsnmove nodegroup1\fR
.IP "5." 3
Move all the nodes in xCAT group \*(L"sngroup1\*(R" to the service node named \*(L"xcatsn2\*(R".
.Sp
\&\fBsnmove sngroup1 \-d xcatsn2\fR
.IP "6." 3
Move all the nodes in xCAT group \*(L"sngroup1\*(R" to the \s-1SN\s0 named \*(L"xcatsn2\*(R" and run extra postscripts.
.Sp
\&\fBsnmove sngroup1 \-d xcatsn2 \-P test1\fR
.IP "7." 3
Move all the nodes in xCAT group \*(L"sngroup1\*(R" to the \s-1SN\s0 named \*(L"xcatsn2\*(R" and do not run anything on the nodes.
.Sp
\&\fBsnmove sngroup1 \-d xcatsn2 \-i\fR
.IP "8." 3
Synchronize any \s-1AIX\s0 statelite files from the primary server for compute03 to the backup server.  This will not actually move the node to it's backup service node.
.Sp
\&\fBsnmove compute03 \-l \-V\fR
.SH "FILES"
.IX Header "FILES"
/opt/xcat/sbin/snmove
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fInoderange\fR\|(3)
