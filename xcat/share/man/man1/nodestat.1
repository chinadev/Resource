.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "NODESTAT.1 1"
.TH NODESTAT.1 1 "2013-02-06" "perl v5.8.8" "User Contributed Perl Documentation"
.SH "Name"
.IX Header "Name"
\&\fBnodestat\fR \- display the running status of each node in a noderange
.SH "\fBSynopsis\fP"
.IX Header "Synopsis"
\&\fBnodestat\fR [\fInoderange\fR] [\fI\-m\fR|\fI\-\-usemon\fR] [\fI\-p\fR|\fI\-\-powerstat\fR] [\fI\-f\fR] [\fI\-u\fR|\fI\-\-updatedb\fR]
.PP
\&\fBnodestat\fR [\fI\-h\fR|\fI\-\-help\fR|\fI\-v\fR|\fI\-\-version\fR]
.SH "\fBDescription\fP"
.IX Header "Description"
\&\fBnodestat\fR  displays and optionally updates the database the running status of a
single or range of nodes or groups.  See \fInoderange\fR\|(3).
.PP
By default, it works as following:
    1. gets the sshd,pbs_mom,xend port status;
    2. if none of them are open, it gets the fping status;
    3. for pingable nodes that are in the middle of deployment, it gets the deployment status;
    4. for non-pingable nodes, it shows 'noping'.
.PP
When \-m is specified and there are settings in the monsetting table, it displays the status of the applications specified in the monsetting table. When \-p is specified it shows the power status for the nodes that are not pingable. When \-u is specified it saves the status info into the xCAT database. Node's pingable status and deployment status is saved in the nodelist.status column. Node's application status is saved in the nodelist.appstatus column.
.PP
To specify settings in the \fBmonsetting\fR table, use 'xcatmon' as the name, 'apps' as the key and the value will be a list of comma separated list of application names. For each application, you can specify the port number that can be queried on the nodes to get the running status. Or you can specify a command that can be called to get the node status from. The command can be a command that can be run locally at the management node or the service node for hierarchical cluster, or a command that can be run remotely on the nodes. 
.PP
The following is an example of the settings in the \fBmonsetting\fR table: 
.PP
.Vb 5
\&    name key value
\&    xcatmon apps ssh,ll,gpfs,someapp
\&    xcatmon gpfs cmd=/tmp/mycmd,group=compute,group=service
\&    xcarmon ll port=9616,group=compute
\&    xcatmon someapp dcmd=/tmp/somecmd
.Ve
.PP
Keywords to use:
.PP
.Vb 6
\&    apps -- a list of comma separated application names whose status will be queried. For how to get the status of each app, look for app name in the key filed in a different row.
\&    port -- the application daemon port number, if not specified, use internal list, then /etc/services. 
\&    group -- the name of a node group that needs to get the application status from. If not specified, assume all the nodes in the nodelist table. To specify more than one groups, use group=a,group=b format.
\&    cmd -- the command that will be run locally on mn or sn.
\&    lcmd -- the command that will be run the the mn only. 
\&    dcmd -- the command that will be run distributed on the nodes using xdsh <nodes> ....
.Ve
.PP
For commands specified by 'cmd' and 'lcmd', the input of is a list of comma separated node names, the output must be in the following format:
.PP
.Vb 3
\&  node1:string1
\&  node2:string2
\&  ...
.Ve
.PP
For the command specified by 'dcmd', no input is needed, the output can be a string. 
.SH "\fBOptions\fP"
.IX Header "Options"
.IP "\fB\-f\fR" 10
.IX Item "-f"
Uses fping instead of nmap even if nmap is available.  If you seem to be having a problem with false negatives, fping can be more forgiving, but slower.
.IP "\fB\-m\fR|\fB\-\-usemon\fR" 10
.IX Item "-m|--usemon"
Uses the settings from the \fBmonsetting\fR talbe to determine a list of applications that need to get status for. 
.IP "\fB\-p\fR|\fB\-\-powerstat\fR" 10
.IX Item "-p|--powerstat"
Gets the power status for the nodes that are 'noping'.
.IP "\fB\-u\fR|\fB\-\-updatedb\fR" 10
.IX Item "-u|--updatedb"
Updates the status and appstatus columns of the nodelist table with the returned running status from the given nodes. 
.IP "\fB\-v\fR|\fB\-\-version\fR" 10
.IX Item "-v|--version"
Print version.
.IP "\fB\-h\fR|\fB\-\-help\fR" 10
.IX Item "-h|--help"
Print help.
.SH "\fBExamples\fP"
.IX Header "Examples"
1.  nodestat compute
.PP
.Vb 5
\& node1   sshd
\& node2   sshd
\& node3   ping
\& node4   pbs
\& node5   noping
.Ve
.PP
2.  nodestat compute \-p
.PP
.Vb 5
\& node1   sshd
\& node2   sshd
\& node3   ping
\& node4   pbs
\& node5   noping(Shutting down)
.Ve
.PP
3. nodestat compute \-u
 node1   sshd
 node2   sshd
 node3   ping
 node4   netboot
 node5   noping
.PP
4. nodestat compute \-m
 node1   ping,sshd,ll,gpfs=ok
 node2   ping,sshd,ll,gpfs=not ok,someapp=something is wrong
 node3   netboot
 node4   noping
.SH "\fBSee\fP \fBAlso\fP"
.IX Header "See Also"
\&\fInoderange\fR\|(3), \fInodels\fR\|(1), \fInodeset\fR\|(8)
